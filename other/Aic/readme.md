# CSIRO Best Baseline.ipynb 概要

## 概要
このNotebookは、Kaggleの「CSIRO - Image2Biomass Prediction」コンペティションにおいて、テストデータに対するバイオマス量の予測を行い、提出用の `submission.csv` ファイルを生成することを目的としています。

推論時には、5分割交差検証（5-fold cross-validation）で学習された5つのモデルのアンサンブルと、テスト時データ拡張（Test-Time Augmentation, TTA）を組み合わせて、予測精度を向上させています。

## モデル
- **アーキテクチャ:** `convnext_tiny`
- **ライブラリ:** `timm`
- **特徴:**
    - 1枚の画像を左右2つに分割し、それぞれの特徴量を抽出して結合するデュアルストリーム（サイアミーズ）方式を採用しています。
    - モデルは `Dry_Total_g`, `GDM_g`, `Dry_Green_g` の3つのターゲットを直接予測します。

## 入力
- **テーブルデータ:** `test.csv` - 予測対象の画像パスとターゲット名が記載されています。
- **画像データ:** `test/` ディレクトリ内のJPEG画像。
- **モデル重み:** 5つの学習済みモデル（`.pth` ファイル）。

## 処理フロー
1.  **データ読み込み:** `test.csv` とテスト画像をロードします。
2.  **モデル読み込み:** 5つの学習済み `convnext_tiny` モデルをロードします。
3.  **テスト時データ拡張 (TTA):** 以下の3つの視点で画像を変換します。
    - 元の画像
    - 水平反転した画像
    - 垂直反転した画像
4.  **予測:**
    - 各TTA視点において、5つのモデルで予測を実行し、その結果を平均します（モデルアンサンブル）。
    - 全てのTTA視点からの予測結果をさらに平均し、最終的な予測値とします。
5.  **後処理:**
    - モデルが直接予測した3つのターゲット値を用いて、残りの2つのターゲット（`Dry_Clover_g`, `Dry_Dead_g`）を計算します。
6.  **提出ファイル作成:** 全ての予測値を `sample_submission.csv` の形式に合わせて整形し、`submission.csv` として保存します。

## 出力
- `submission.csv`: Kaggleコンペティション提出用の予測結果ファイル。

## 主要なライブラリ
- `torch`
- `pandas`
- `numpy`
- `timm`
- `albumentations`
- `opencv-python`
